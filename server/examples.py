EXAMPLES = [
    {
        "name": "Real World Sample",
        "mode": "render",
        "inputJson": """{\n    "cb_data": [\n        {\n            "Entity": "Hostname",\n            "EntityResult": {\n                "systemvolume_total_size": "479127379968",\n                "computer_name": "TEST",\n                "os_environment_display_string": "Windows 10 Professional, 64-bit",\n                "systemvolume_free_size": "319940304896",\n                "physical_memory_size": "17058787328",\n                "emet_version": "",\n                "emet_dump_flags": "",\n                "clock_delta": "10840",\n                "supports_cblr": "True",\n                "id": 11,\n                "is_isolating": "False",\n                "emet_process_count": 0,\n                "build_id": 2,\n                "uptime": "1640459",\n                "computer_dns_name": "TEST.COMPANY.LOCAL",\n                "emet_report_setting": " (Locally configured)",\n                "last_update": "2018-06-25 13:27:47.442521+03:00",\n                "parity_host_id": "0",\n                "power_state": 0,\n                "network_isolation_enabled": "False",\n                "uninstalled": "None",\n                "next_checkin_time": "2018-06-25 13:28:13.089904+03:00",\n                "status": "Offline",\n                "num_eventlog_bytes": "13771",\n                "sensor_health_message": "Elevated memory usage",\n                "build_version_string": "1.1.1.1",\n                "computer_sid": "S-1-5-21-2809203804-286580391-3190870472",\n                "node_id": 0,\n                "event_log_flush_time": "None",\n                "emet_exploit_action": " (Locally configured)",\n                "emet_telemetry_path": "",\n                "license_expiration": "1990-01-01 00:00:00+02:00",\n                "supports_isolation": "True",\n                "emet_is_gpo": "False",\n                "supports_2nd_gen_modloads": "False",\n                "network_adapters": "1.1.1.1,d4258bf480fd|",\n                "sensor_health_status": 90,\n                "registration_time": "2018-03-01 08:12:47.420579+02:00",\n                "restart_queued": "False",\n                "notes": "None",\n                "num_storefiles_bytes": "0",\n                "os_environment_id": 5,\n                "cookie": 292474955,\n                "shard_id": 0,\n                "boot_id": "20",\n                "last_checkin_time": "2018-06-25 13:27:43.091387+03:00",\n                "os_type": 1,\n                "group_id": 1,\n                "display": "True",\n                "sensor_uptime": "3",\n                "uninstall": "False"\n            }\n        }\n    ],\n    "cyl_data": [\n        {\n            "Entity": "PC-01",\n            "EntityResult": {\n                "update_available": false,\n                "date_last_modified": "2012-01-16T10:04:27",\n                "distinguished_name": "CN=PC-01,CN=Computers,DC=DOMAIN,DC=COM",\n                "policy": {\n                    "id": "1413b00e-50bc-4438-base-04935713aabf",\n                    "name": "A_policy"\n                },\n                "date_offline": null,\n                "ip_addresses": [\n                    "1.92.168.0.3"\n                ],\n                "mac_addresses": [\n                    "AB-CD-C4-12-A2-73"\n                ],\n                "last_logged_in_user": "DOMAIN\\\\user",\n                "agent_version": "2.0.1510",\n                "os_version": "Microsoft Windows 10 Pro",\n                "state": "Online",\n                "update_type": null,\n                "date_first_registered": "2012-03-27T11:35:12",\n                "host_name": "PC-01.DOMAIN.COM",\n                "is_safe": true,\n                "background_detection": false,\n                "id": "8e501f3b-d3c3-4549-94af-5b3335af247d",\n                "name": "PC-01"\n            }\n        }\n    ],\n    "ad_data": [\n        {\n        "Entity": "xxxxB2019-EX",\n        "EntityResult": {\n            "accountExpires": [\n                "9999-12-31 23:59:59.999999+00:00"\n            ],\n            "badPasswordTime": [\n                "1601-01-01 00:00:00+00:00"\n            ],\n            "badPwdCount": [\n                0\n            ],\n            "cn": [\n                "xxxxB2019-EX"\n            ],\n            "codePage": [\n                0\n            ],\n            "countryCode": [\n                0\n            ],\n            "dNSHostName": [\n                "xxxxB2019-EX.xxxxb2019.local"\n            ],\n            "dSCorePropagationData": [\n                "2021-03-01 22:14:54+00:00",\n                "2021-03-01 22:14:54+00:00",\n                "2021-03-01 22:13:05+00:00",\n                "2021-03-01 22:13:04+00:00",\n                "1601-07-14 22:36:49+00:00"\n            ],\n            "distinguishedName": [\n                "CN=xxxxB2019-EX,CN=Computers,DC=xxxxb2019,DC=local"\n            ],\n            "instanceType": [\n                4\n            ],\n            "isCriticalSystemObject": [\n                false\n            ],\n            "lastLogoff": [\n                "1601-01-01 00:00:00+00:00"\n            ],\n            "lastLogon": [\n                "2021-05-27 16:45:33.537247+00:00"\n            ],\n            "lastLogonTimestamp": [\n                "2021-05-21 02:00:28.131941+00:00"\n            ],\n            "localPolicyFlags": [\n                0\n            ],\n            "logonCount": [\n                884\n            ],\n            "mail": [],\n            "managedBy": ["CN=Test Test,OU=Users"],\n            "memberOf": [\n                "CN=Exchange Install Domain Servers,CN=Microsoft Exchange System Objects,DC=xxxxb2019,DC=local",\n                "CN=Managed Availability Servers,OU=Microsoft Exchange Security Groups,DC=xxxxb2019,DC=local",\n                "CN=Exchange Trusted Subsystem,OU=Microsoft Exchange Security Groups,DC=xxxxb2019,DC=local",\n                "CN=Exchange Servers,OU=Microsoft Exchange Security Groups,DC=xxxxb2019,DC=local"\n            ],\n            "msDS-SupportedEncryptionTypes": [\n                28\n            ],\n            "msDS-UserPasswordExpiryTimeComputed": [\n                9223372036854775807\n            ],\n            "msExchCapabilityIdentifiers": [\n                1\n            ],\n            "msExchRMSComputerAccountsBL": [\n                "CN=FederatedEmail.123-123-123-123-123,CN=Users,DC=xxxxb2019,DC=local"\n            ],\n            "name": [\n                "xxxxB2019-EX"\n            ],\n            "objectCategory": [\n                "CN=Computer,CN=Schema,CN=Configuration,DC=xxxxb2019,DC=local"\n            ],\n            "objectClass": [\n                "top",\n                "person",\n                "organizationalPerson",\n                "user",\n                "computer"\n            ],\n            "objectGUID": [\n                "{123-123-123-123-123}"\n            ],\n            "objectSid": [\n                "S-1-5-21-123-123-123-123"\n            ],\n            "operatingSystem": [\n                "Windows Server 2019 Standard Evaluation"\n            ],\n            "operatingSystemVersion": [\n                "10.0 (17763)"\n            ],\n            "primaryGroupID": [\n                515\n            ],\n            "pwdLastSet": [\n                "2021-05-01 14:28:29.910906+00:00"\n            ],\n            "sAMAccountName": [\n                "xxxxB2019-EX$"\n            ],\n            "sAMAccountType": [\n                805306369\n            ],\n            "servicePrincipalName": [\n                "IMAP/xxxxB2019-EX",\n                "IMAP/xxxxB2019-EX.xxxxb2019.local",\n                "IMAP4/xxxxB2019-EX",\n                "IMAP4/xxxxB2019-EX.xxxxb2019.local",\n                "POP/xxxxB2019-EX",\n                "POP/xxxxB2019-EX.xxxxb2019.local",\n                "POP3/xxxxB2019-EX",\n                "POP3/xxxxB2019-EX.xxxxb2019.local",\n                "exchangeRFR/xxxxB2019-EX",\n                "exchangeRFR/xxxxB2019-EX.xxxxb2019.local",\n                "exchangeAB/xxxxB2019-EX",\n                "exchangeAB/xxxxB2019-EX.xxxxb2019.local",\n                "exchangeMDB/xxxxB2019-EX",\n                "exchangeMDB/xxxxB2019-EX.xxxxb2019.local",\n                "SMTP/xxxxB2019-EX",\n                "SMTP/xxxxB2019-EX.xxxxb2019.local",\n                "SmtpSvc/xxxxB2019-EX",\n                "SmtpSvc/xxxxB2019-EX.xxxxb2019.local",\n                "TERMSRV/xxxxB2019-EX",\n                "TERMSRV/xxxxB2019-EX.xxxxb2019.local",\n                "WSMAN/xxxxB2019-EX",\n                "WSMAN/xxxxB2019-EX.xxxxb2019.local",\n                "RestrictedKrbHost/xxxxB2019-EX",\n                "HOST/xxxxB2019-EX",\n                "RestrictedKrbHost/xxxxB2019-EX.xxxxb2019.local",\n                "HOST/xxxxB2019-EX.xxxxb2019.local"\n            ],\n            "uSNChanged": [\n                119324\n            ],\n            "uSNCreated": [\n                12744\n            ],\n            "userAccountControl": [\n                4096\n            ],\n            "whenChanged": [\n                "2021-05-21 02:00:28+00:00"\n            ],\n            "whenCreated": [\n                "2021-03-01 18:23:27+00:00"\n            ]\n        }\n    }\n    ],\n    "exabeam_data": [\n        {}\n    ]\n}""",
        "template": """{% for endpoint in input_json.cb_data %}\n    {% if endpoint|length > 0 %}\n        Carbon Black Response\n        <hr>\n        System Uptime: {{ endpoint.EntityResult.sensor_uptime }}\n        {% if endpoint.EntityResult.status == "Online" %}\n            Status: {{ endpoint.EntityResult.status }}\n        {% else %}\n            Status: {{ endpoint.EntityResult.status }}\n        {% endif %}\n        Health Status: {{ endpoint.EntityResult.sensor_health_message }}\n        Last Sensor Check-in: {{ endpoint.EntityResult.last_checkin_time }}\n        Network Adapter Details: {{ endpoint.EntityResult.network_adapters.strip("|=\n        ") }}\n    {% else %}\n        No data was returned by CarbonBlack.\n    {% endif %}\n{% endfor %}\n\n{% for endpoint in input_json.cyl_data %}\n    {% if endpoint|length > 0 %}\n        Cylance\n        <hr>\n        Last User: {{ endpoint.EntityResult.last_logged_in_user }}\n        IP address: {{ ''.join(endpoint.EntityResult.ip_addresses) }}\n        MAC Address: {{ ''.join(endpoint.EntityResult.mac_addresses) }}\n        Policy: {{ endpoint.EntityResult.policy.name }}\n        {% if endpoint.EntityResult.state == "Online" %}\n            Device State: {{ endpoint.EntityResult.state }}\n        {% else %}\n            Device State: {{ endpoint.EntityResult.state }}\n        {% endif %}\n        Cylance Update Available?: {{ endpoint.EntityResult.update_available }}\n        Is Safe?: {{ endpoint.EntityResult.is_safe }}\n    {% else %}\n        No data was returned by Cylance.\n    {% endif %}\n{% endfor %}\n\n{% for endpoint in input_json.ad_data %}\n    {% if endpoint|length > 0 %}\n        Active Directory\n        <hr>\n        Operating System: {{ endpoint.EntityResult.operatingSystem.0 }}\n        OS Version: {{ endpoint.EntityResult.operatingSystemVersion.0 }}\n        {% set only_cn = endpoint.EntityResult.managedBy.0.split(',') %}\n        {% set only_cn = only_cn[0].strip("CN=") %}\n        Managed by: {{ only_cn }}\n    {% else %}\n        No data was returned by ActiveDirectory.\n    {% endif %}\n{% endfor %}\n\n{% for endpoint in input_json.exabeam_data %}\n    {% if endpoint|length > 0 %}\n        Exabeam\n        <hr>\n    {% else %}\n        No data was returned by Exabeam.\n    {% endif %}\n{% endfor %}"""
    }, {
        "name": "Charts",
        "mode": "render",
        "inputJson": """{\n    "Pie": {\n        "sample_score": 35,\n        "sample_created": "2019-09-07T15:50:10+00Z",\n        "sample_type": "URL",\n        "sample_webif_url": "google.com"\n    },\n    "BarChart": {\n        "num_of_engines": 100,\n        "last_analysis_stats": {\n            "harmless": 15,\n            "malicious": 50,\n            "suspicious": 25,\n            "timeout": 7,\n            "undetected": 3\n      }\n    }\n}""",
        "template": """<h6>Pie Chart</h6>\n{#- Try to change Pie.sample_score -#}\n{%- set percentage_detect = (input_json.Pie.sample_score / 100 ) * 100 -%}\n<table><tr><td style="vertical-align:top;"><svg viewBox="0 0 32 32" width="80px" height="80px" style="transform: rotate(-90deg);background: green;border-radius: 50%;vertical-align:top;"><circle r="16" cx="16" cy="16" style="fill: green;stroke: red;stroke-width: 32;stroke-dasharray: {{ percentage_detect|round|int }} 100;"/></svg></td><td><p style="margin:  0px 0px 0px 10px;"><b>VTI Score:</b> {{ input_json.Pie.sample_score }}/100</p><p style="margin:  0px 0px 0px 10px;"><b>Scan Date:</b> {{ input_json.Pie.sample_created }} </p><p style="margin:  0px 0px 0px 10px;"><b>Sample Type:</b> {{ input_json.Pie.sample_type }} </p><p style="margin:  0px 0px 0px 10px;"><b>Sample URL:</b> {{ input_json.Pie.sample_webif_url }}</p></td></tr></table>\n\n<h6>Bar Chart</h6>\n{%- set harmless = (input_json.BarChart.last_analysis_stats.harmless /input_json.BarChart.num_of_engines) * 100 -%}\n{%- set malicious = (input_json.BarChart.last_analysis_stats.malicious /input_json.BarChart.num_of_engines) * 100 -%}\n{%- set suspicious = (input_json.BarChart.last_analysis_stats.suspicious /input_json.BarChart.num_of_engines) * 100 -%}\n{%- set timeout = (input_json.BarChart.last_analysis_stats.timeout /input_json.BarChart.num_of_engines) * 100 -%}\n{%- set undetected = (input_json.BarChart.last_analysis_stats.undetected /input_json.BarChart.num_of_engines) * 100 -%}\n<b>Total Number of Engines</b>: {{ input_json.BarChart.num_of_engines }}\n<table style="width: 100%;">\n    <tr>\n        <td style="width: 70px;">Harmless</td>\n        <td><div style="color: black; background-color:green; width:{{ harmless }}%;">{{ harmless|int }}</div></td>\n    </tr>\n    <tr>\n        <td>Malicious</td>\n        <td><div style="color: black; background-color: red; width: {{ malicious }}%;">{{ malicious|int }}</div></td>\n    </tr>\n    <tr>\n        <td>Suspicious</td>\n        <td><div style="color: black; background-color: orange; width: {{ suspicious }}%;">{{ suspicious|int }}</div></td>\n    </tr>\n    <tr>\n        <td>Timeout</td>\n        <td><div style="color: black; background-color: yellowgreen; width: {{ timeout }}%;">{{ timeout|int }}</div></td>\n    </tr>\n    <tr>\n        <td>Undetected</td>\n        <td><div style="color: black; background-color: gray; width: {{ undetected }}%;">{{ undetected|int }}</div></td>\n    </tr>\n</table>\n"""
    }
]
